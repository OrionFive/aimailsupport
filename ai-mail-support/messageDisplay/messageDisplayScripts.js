(()=>{function e(){return document.querySelector("#amsOuterResponse")?.shadowRoot?.querySelector("#amsInnerResponse")}function t(n=!0){n?document.querySelector("#amsOuterResponse").classList.remove("show"):document.querySelector("#amsOuterResponse").classList.add("show"),e().classList.remove("error"),e().classList.remove("thinking"),e().querySelector("#amsContent").innerHTML=""}(async()=>{browser.runtime.onMessage.addListener(async n=>{var s,r,o,a;if(n?.type)switch(function(){if(document.querySelector("#amsOuterResponse"))return;let e=document.createElement("div");e.id="amsOuterResponse";let n=e.attachShadow({mode:"open"}),s=document.createElement("div");s.id="amsInnerResponse",n.appendChild(s);let r=document.createElement("link");r.rel="stylesheet",r.href=browser.runtime.getURL("/messageDisplay/messageDisplayScripts.css"),s.appendChild(r);let o=document.createElement("img");o.id="amsImage",o.src=browser.runtime.getURL("/images/bot-icon-color-64.webp"),s.appendChild(o);let a=document.createElement("div");a.id="amsContent",s.appendChild(a);let c=document.createElement("img");c.id="amsClose",c.src=browser.runtime.getURL("/images/close-icon.svg"),c.addEventListener("click",()=>t()),s.appendChild(c),document.body.insertBefore(e,document.body.firstChild)}(),n.type){case"addAudio":!function(n){t(!1);let s=new FileReader;s.onload=()=>{let t=s.result,n=document.createElement("audio");n.src=t,n.autoplay=!0,n.controls=!0,e().querySelector("#amsContent").appendChild(n)},s.readAsDataURL(n)}(n.content);break;case"addChart":;a=n.content,t(!1),e().querySelector("#amsContent").append(document.createElement("div"));break;case"addText":s=n.content,t(!1),e().querySelector("#amsContent").textContent=s;break;case"showError":r=n.content,t(!1),e().classList.add("error"),e().querySelector("#amsContent").textContent=r;break;case"thinking":o=n.content,t(!1),e().classList.add("thinking"),e().querySelector("#amsContent").innerHTML=`${o}<span class="dots"></span>`}})})()})();