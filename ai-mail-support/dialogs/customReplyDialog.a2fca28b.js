const e=document.getElementById("dialog-label"),t=document.getElementById("dialog-input"),n=document.getElementById("dialog-submit-button"),o=document.getElementById("dialog-cancel-button");let r=null;function i(e){let t=RegExp("[\\?&]"+(e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]"))+"=([^&#]*)").exec(location.search);return null===t?null:decodeURIComponent(t[1].replace(/\+/g," "))}async function l(e,t){if(!r){console.error("Cannot send response, promptId is missing."),alert("Internal error: Missing prompt identifier.");return}if(!browser?.runtime){console.error("browser.runtime API is not available."),alert("Error: Could not communicate with the background script.");return}try{await browser.runtime.sendMessage({type:"dialogResponse",status:e,promptId:r,value:t}),window.close()}catch(e){console.error("Error sending dialog response message:",e),alert(`Error sending response: ${e.message}`)}}async function s(){try{let e=await browser.windows.getCurrent();if(e.id){let t=window.screen.availWidth,n=window.screen.availHeight,o=Math.round((t-450)/2),r=Math.round((n-300)/2);await browser.windows.update(e.id,{width:450,height:300,left:o,top:r}),console.log("Attempted to resize window to 450x300 and center.")}else console.warn("Could not get current window ID to resize/center.")}catch(e){console.error("Error trying to resize/center window:",e)}}n.addEventListener("click",async()=>{let e=t.value.trim();e?l("submitted",e):(t.focus(),alert("Please enter some input."))}),o.addEventListener("click",()=>{window.close()}),window.addEventListener("DOMContentLoaded",()=>{r=i("promptId");let o=i("title")||"Input Required",l=i("label")||"Enter value:",a=i("buttonText")||"Submit",d=i("defaultValue")||"";document.title=o,e&&(e.textContent=l),t&&(t.value=d),n&&(n.textContent=a),t&&t.focus(),s()});